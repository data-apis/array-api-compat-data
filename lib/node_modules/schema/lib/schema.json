{
  "$id": "https://data-apis.org/array-api-compat-data.schema.json",
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "Schema for Array API compatibility data.",
  "type": "object",

  "$defs": {

    "compatibility": {
      "description": "compatibility data",
      "type": "object",
      "properties": {
        "__compat": {
          "$ref": "#/$defs/__compat"
        }
      },
      "additionalProperties": {
        "$ref": "#/$defs/nested-compatibility"
      },
      "required": [
        "__compat"
      ]
    },

    "nested-compatibility": {
      "description": "nested compatibility data",
      "type": "object",
      "properties": {
        "__compat": {
          "$ref": "#/$defs/nested-__compat"
        }
      },
      "additionalProperties": {
        "$ref": "#/$defs/nested-compatibility"
      },
      "required": [
        "__compat"
      ]
    },

    "__compat": {
      "type": "object",
      "properties": {
        "version_added": {
          "$ref": "#/$defs/version_added"
        },
        "description": {
          "description": "description",
          "type": "string",
          "minLength": 1
        },
        "spec_url": {
          "$ref": "#/$defs/spec_url"
        },
        "support": {
          "$ref": "#/$defs/support"
        },
        "status": {
          "$ref": "#/$defs/status"
        }
      },
      "required": [
        "version_added",
        "description",
        "spec_url",
        "support",
        "status"
      ],
      "additionalProperties": false
    },

    "nested-__compat": {
      "type": "object",
      "properties": {
        "version_added": {
          "$ref": "#/$defs/version_added"
        },
        "description": {
          "description": "description",
          "type": "string",
          "minLength": 1
        },
        "support": {
          "$ref": "#/$defs/support"
        },
        "status": {
          "$ref": "#/$defs/status"
        }
      },
      "required": [
        "version_added",
        "description",
        "support",
        "status"
      ],
      "additionalProperties": false
    },

    "version_added": {
      "description": "version added",
      "type": "string",
      "minLength": 1
    },

    "spec_url": {
      "description": "specification URL",
      "type": "string",
      "pattern": "^https:\/\/data-apis.org\/array-api\/"
    },

    "support": {
      "description": "array library support data",
      "type": "object",
      "patternProperties": {
        ".+": {
          "oneOf": [
            {
              "type": "null"
            },
            {
              "$ref": "#/$defs/support-array"
            }
          ]
        }
      }
    },
    "support-array": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/support-array-item"
      }
    },
    "support-array-item": {
      "description": "support data for a specific array library",
      "type": "object",
      "properties": {
        "version_added": {
          "$ref": "#/$defs/version_added"
        },
        "status": {
          "$ref": "#/$defs/support-status"
        },
        "notes": {
          "description": "additional context, such as provisional availability, implementation notes, partial support, et cetera, for a specific array library",
          "type": "string"
        }
      },
      "required": [
        "version_added",
        "status",
        "notes"
      ],
      "additionalProperties": false
    },
    "support-status": {
      "description": "status of API support for a specific array library",
      "type": "object",
      "properties": {
        "experimental": {
          "description": "boolean indicating whether support within an array library is experimental",
          "type": "boolean"
        },
        "deprecated": {
          "description": "boolean indicating whether an array library has deprecated support for specification-defined behavior",
          "type": "boolean"
        },
        "partial_implementation": {
          "description": "boolean indicating whether an array library implementation only partially conforms to the specification",
          "type": "boolean"
        }
      },
      "required": [
        "experimental",
        "deprecated",
        "partial_implementation"
      ],
      "additionalProperties": false
    },

    "status": {
      "description": "specification status",
      "type": "object",
      "properties": {
        "standard_track": {
          "description": "boolean indicating whether an API (or behavior) is on the standards track",
          "type": "boolean"
        },
        "experimental": {
          "description": "boolean indicating whether an API (or behavior) is considered experimental according to the Array API specification and subject to change",
          "type": "boolean"
        },
        "deprecated": {
          "description": "boolean indicating whether an API has been deprecated in the Array API specification",
          "type": "boolean"
        }
      },
      "required": [
        "standard_track",
        "experimental",
        "deprecated"
      ],
      "additionalProperties": false
    }
  },

  "patternProperties": {
    ".+": {
      "$ref": "#/$defs/compatibility"
    }
  }
}
